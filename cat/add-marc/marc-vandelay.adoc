Batch Import Bibliographic Records
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

If the title records you need are not already in the Evergreen database, it is possible to upload vendor-supplied MARC files into Evergreen. Each file may contain one or more MARC records. During the uploading process, Evergreen matches each record in the file with existing records in Evergreen based on pre-defined match points called Record Match Sets. Records without matches may be imported directly into the catalogue. Records with matches must be examined by cataloguers. Due to the nature of Sitka's shared database, the Co-op suppport strongly advises against allowing Evergreen to select a merge target and cautions you to adhere to instructions for selecting a match as outlined in this chapter.

Importing records involves two steps: 1. all records in the file are first uploaded to the server and kept outside the catalogue as a queue; 2. cataloguers view the records in the queue to import them into Evergreen catalogue. Cataloguers can view both the incoming and existing matching records to decide which one to use by selecting an appropirate merge profile. You may merge the records with either the incoming or existing record as the lead while keeping some MARC tags in both records. Overlay/Merge Profile decides how two records are merged.

Holding records can be created if the incoming MARC records contain holding information in pre-defined format. Contact Co-op support about the acceptable format if you want to load holding records.

All records in a queue can be exported to a CSV file or printed in non-MARC format (emailing is not available yet). All records imported from a single queue can be added to a Record Bucket.

[TIP]
=====
. There are some settings, namely *Record Display Attributes,Record Match Sets, Merge/Overlay Profiles* and *Import Item Attributes* on this screen that are reserved for Sitka server administration. You should not attempt to edit them as they affect all bibliographic records.
+
. *Record Display Attributes* set what fields will display on Inspect Queue screen, once a file of records have been loaded. Important descriptive MARC tags and control numbers are selected to display.
+
. *Record Match Sets* are profiles set up by Sitka to allow for different match points to be used when loading records. The default profile is SitkaMatch. It matches on the 901c (record id), 010a (LC Control Number), 020a (ISBN), 022a (ISSN), or 035a (System Control Number). It is used in the majority of record loads. The other profiles are only used to load special records. Please contact Co-op support for which profile to use if your records require a set of different match points to load.
+
. *Merge/Overlay Profiles* control how the incoming and existing MARC records are merged. Two profiles have been created for all Sitka libraries to use: Merge Using INCOMING Record and Merge Using EXISTING Record. Z39.50 Overlay is used when overlaying a record via Z39.50 interface.
+
* *Merge Using INCOMING Record*: all tags in the INCOMING record will be brought into the final record. Tags: 092, 590, 595, 690, 852 and 856 in the ORIGINAL record will be preserved in the final record. The rest will be removed.
+
* *Merge Using EXISTING Record*: all tags in the ORIGINAL record will be kept. Tags: 092, 590, 595, 690, 852 and 856 in the INCOMING record will be brought into the final record. The rest will be removed upon merge.
+
These profiles ensure local data in these six fields in a merged MARC record is never overwritten, and holding records (in tag 852) can be loaded to either the existing MARC record or with the incoming record.
+
. *Import Item Attributes* are profiles set up by Sitka to allow importing of item records with vendor supplied MARC records. The vendor will need to send item level information in a local MARC tag and subfields (eg. 9xx or 852), and this information can be mapped into item records when the bibliographic records are loaded. Please contact Co-op support if you are interested in loading item records with your bibliographic records.
=====

Uploading MARC Record Files
^^^^^^^^^^^^^^^^^^^^^^^^^^^^

. Select *Cataloguing-> MARC Batch Import/Export*
+
image:images/cat/vandelay-1.png[]
+
. The MARC File Upload screen opens.
+
image:images/cat/vandelay-2.png[]
+
. You may create a new queue for the file you are to upload or append the file's records to an existing queue. To create a new queue, type in a name for your file in the box beside Create a New Upload Queue. To append records to an existing queue, choose a queue from the dropdown list beside Add to an Existing Queue.
+
[CAUTION]
=========
Do not use "/" or "\" (slash or backslash) in import queue name.
=========
+
. Leave *SitkaMatch* in Record Match Set box.
+
[CAUTION]
=========
The NoMatch profile matches records on tag 901$c only, and should only be used after a false match is detected using SitkaMatch as described below. Sitka cataloguing policy strives to avoid record duplication so Sitka policy requires batch imports use SitkaMatch first.
=========
+
. Choose a Holdings Import Profile from the dropdown list, if your MARC records include holdings information and you wish to load it.
+
[CAUTION]
=========
You need to contact Co-op support for holding information format before asking your vendors to include it in the MARC records. Holdings may not be loaded, or cause loading error, if the format does not match Sitka's holding profile.
=========
+
. Select a Record Source from the dropdown. The default is oclc, but choose the one that best matches your file (eg. ULS, Whitehots etc.) Contact Co-op support if you need to load records for non-physical items, such as an e-record collection like ebrary.
+
. You do not need to choose a Merge Profile now.
+
. Check *Import Non-Matching Records* box to automatically import records without matches into the catalogue.
+
[CAUTION]
=========
Co-op support strongly advises that you do not select other import options. These options allow Evergreen to automatically merge records before you inspect them. It is best practice to inspect the potentially merged records first.
=========
+
[TIP]
=====
If you want to view your incoming records first without importing any, you may leave Import Non-Matching Records box unchecked. You will be able to view all records in the file on Inspect Queue and import all/selected records with/without matching records there.
=====
+
. You do not need to select any of the checkboxes in Copy Import Actions now.
+
. Click *Choose File* to choose the source MARC file on your computer, then click *Upload*. Depending on the size of the file, it may take a while for the uploading to finish. Once it is finished, records will be displayed in Inspect Queue view. You may continue to examine and import records in the queue as described below. Or you may come back later to find the queue to examine and import the records.
+
[CAUTION]
=========
Do not load a MARC file of more than 500 records, as the importing process can time out. If you have more than 500 records, please break into multiple files.
=========
+
[TIP]
=====
Records in a queue are saved on the server, but outside the catalogue. By importing, you bring the records into the catalogue.
=====

Importing and Merging Records from Queues
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

If you want to import records from MARC files already uploaded, go to *Cataloguing -> MARC Batch Export/Import*, then click *Inspect Queue*. Click the queue that you wish to examine and import records from. The Queue Summary screen will open.

If you continue to import records right after uploading the MARC file, the Queue Summary screen is loaded after you upload the file.
