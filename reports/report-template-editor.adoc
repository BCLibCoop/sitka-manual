Report Template Editor
----------------------

The report template editor is made up of three section:

. Basic Information
. Field and Filter Selector
. Field and Filter Display

image::images/report/report-template-editor-1.png[]

Basic Information
~~~~~~~~~~~~~~~~~

The basic information section of the report template editor is where you can update the template name,
description, and documentation URL.

When cloning an existing template these fields will be auto-populated with the values from the original 
template and (clone) will be added to the end of the template name.

If you have local online documentation that pertains to a report you can add it in the Documentation URL
field and it will be included as a link in the report output.


Field and Filter Selector
~~~~~~~~~~~~~~~~~~~~~~~~~

The field and filter selector is where you build your display fields and filters for your template.

Core Source
^^^^^^^^^^^

You can not change the starting source table, but have to follow the links to tables in the Sources pane. 
Changing the starting table will remove all existing fields, meaning building a new template from scratch.


Source Path
^^^^^^^^^^^

Add Fields
^^^^^^^^^^

Field and Filter Display
~~~~~~~~~~~~~~~~~~~~~~~~


Display Fields
^^^^^^^^^^^^^^

Display fields are the columns of information that will display on your report output.  The *Display
Fields* tab is the active tab by default in the _Report Template Editor_.

[NOTE]
======
The action *Change Column Documentation* on the *Display Fields* tab can be ignored as it does not
apply to display fields.
======


Reordering  Fields
++++++++++++++++++

. On the *Display Fields* tab select the field you would like to re-order.
. From the *Actions* menu choose *Move Field Up* or *Move Field Down*.  You can also right-click on the
field to open the *Actions* menu.
+
image::images/report/report-display-fields-1.png[]
+
. Repeat until your fields are in the order you desire.


Renaming a Field
++++++++++++++++

Each dislay field in a template has a column label which displays as the column header in the report output.

. On the *Display Fields* tab select the field you would like to rename.
. From the *Actions* menu choose *Change Column Label*. You can also right-click on the
field to open the *Actions* menu.
+
image::images/report/report-display-fields-2.png[]
+
. In the pop-up that appears enter the new name for the field and click *OK/Continue*.
+
image::images/report/report-display-fields-3.png[]
+
. The new field name displays in the _Column Label_ column and will display as the column header on your report
output.

[NOTE]
======
It is best practice to include qualifiers in the field names for fields like barcode and library so that 
staff know what data they are looking at in the report output.

For example, for multi-branch libraries and libraries participating in reciprocal borrowing it is not uncommon for the
Circulating Library and Owning Library of an item to be different.  In this case it is important to specify
in the field name which type of library is being presented in the report output data.
======

Changing a Transform
++++++++++++++++++++


Removing a Field
++++++++++++++++

[CAUTION]
=========
Removing display fields usually does not affect the result set for the report output but it can, especially
when the report output displays a count of records (whether item, patron, circulation, hold, or bibliographic).

When removing fields be mindful of whether or not it will still be clear in the report output what your results
mean. 
=========

. On the *Display Fields* tab select the field you would like to rename.
. From the *Actions* menu choose *Remove Field*. You can also right-click on the
field to open the *Actions* menu.
+
image::images/report/report-display-fields-4.png[]
+
. The selected field is removed and no longer shows as a display field.



Filters
^^^^^^^

Changing the Column Documentation
+++++++++++++++++++++++++++++++++

When running a report the filter can include text which gives information on how to use the particular filter and
in some cases how to enter the filter value.  In the _Report Template Editor_ this is referred to as column
documentation or a field hint.

image::images/report/report-filters-1.png[]

. On the *Filter* tab select the field you would like to add column documentation to.
. From the *Actions* menu choose *Change Column Documentation*. You can also right-click on the
field to open the *Actions* menu.
+
image::images/report/report-filters-2.png[]
+
. In the pop-up that appears add or update the text and click *OK/Continue*.
+
image::images/report/report-filters-3.png[]
+
. When running a report the column documentation will display under the filter path. 
+
image::images/report/report-filters-4.png[]


Changing an Operator
++++++++++++++++++++



. On the *Filter* tab select the field you would like change the operator of.
. From the *Actions* menu choose *Change Operator*. You can also right-click on the
field to open the *Actions* menu.
+
image::images/report/report-filters-operator-1.png[]
+
. In the pop-up that appears select the new operator from the list and click *OK/Continue*.
+
image::images/report/report-filters-operator-2.png[]
+
. The operator will be updated in the grid.


Changing a Transform
++++++++++++++++++++

Updating a Filter Value
+++++++++++++++++++++++

Removing a Filter
++++++++++++++++

. On the *Display Fields* tab select the field you would like to rename.
. From the *Actions* menu choose *Remove Field*. You can also right-click on the
field to open the *Actions* menu.
+
image::images/report/report-filters-X.png[]
+
. The selected field is removed and no longer shows as a display field.


Data Types
^^^^^^^^^^

The central column of the Database Source Browser lists Field Name and Data Type for the selected database
table.


Data Type is associated with each field. It tells what kind of information is stored in the field. The system
handles the information differently based on the data type. Each data type has its own characteristics and
uses:

[options="header"]
|===
|Data Type |Description    |Notes
|Boolean    |Contains either "true" or "false".    |Examples in Evergreen: "deleted" in item/patron record, "circulate?" in item record.
|ID    |Unique number assigned by the database to identify a record    |IDs look like numbers, but the id data type is treated specially by the software for determining how tables are linked. Id is a good candidate field for counting records.
|Integer    |A number like 1, 2, 3.    |Examples in Evergreen: "remaining renewal count" in circulation record, "claimed returned count" in patron record.
|Interval    |Time intervals, such as "2 weeks" and "6 months"    |Examples in Evergreen: "loan duration" and "grace period" in circulation record,
|Link    |It is similar to the id data type. It is the id of a record in another table.    |Examples in Evergreen: "user id" and "item id" in a circulation record. Link outputs a number that is a meaningful reference for the database but not of much use to a human user. You will usually want to drill further down the tree in the Sources pane and select fields from the linked table. However, in some instances you might want to use a link field. For example, to count the number of patrons who borrowed items you could do a count on the "user id" in the circulation record.
|Money    |Monetary amount    |Examples in Evergreen: "price" in item record, "billing amount" in billing record.
|Org_unit    |Organizational unit. It is a number. It acts like link data type.    |In Evergreen, libraries are organizational units. In Sitka context they are organized into a tree structure with consortium, library federations, libraries/library systems and branches for library systems. To filter on a library, make sure you choose the field having org_unit data type. To display a library, it is a better option to drill down to the org unit record to display the "name" of it.
|Text    |Text field. Usually it takes whatever is typed into the field.    |Examples: "call number label" in call number record, "patron's names".
|Timestamp    |A very detailed time such as 2018-11-25 17:54:26-07    |Example: checkout time in circulation record, last status date in item record.
|===

Evergreen uses icons to indicate data type on the report interface.

image::images/report/term-1.png[]


Field Transforms
^^^^^^^^^^^^^^^^

Transforms determine how data is processed when it is retrieved from the database. Different data types can
be transformed differently. Not all transforms are available to a certain data type.


[options="header"]
|===
|Transform |Applicable Data Types |Description | Notes
|Raw Data |All Data Types |To display the data exactly as it is stored in the database. 
|Date |Timestamps |  This transform presents a timestamp as a human-readable date in yyyy-mm-dd format. For example,
timestamp 2018-11-25 17:54:26-07 will be displayed as 2018-11-25. 
|Year + Month |Timestamps | Presents a timestamp as the year and month in yyyy-mm format. For example, 2018-11-25
17:54:26-07 will be displayed as 2018-11. If filtering on a timestamp transformed to Year + Month, all
days in the calendar month are included. It is available to timestamp field.
|Upper Case |Text | Transforms text to all upper case. 
|Lower Case |Text | Transforms text to all lower case. 
|Substring |Text | This transform can be applied to filters, not display fields. It matches the given value with a
continuous string of characters in the field. For example, if a given value is "123" and the match is with a
call number field, call numbers like "123.34", "ANF 123.34", "JNF 233.123", etc. will be in the result list.
|First Continuous Non-space string |Text |  The first word (or string of numbers and/or characters until the first
spacing) in a field is returned by this transform. For example, this transform will return "E" from text
"E DOR", "E 123", etc. 
|Count |Text, Integer, ID, Money, Timestamp, Org_unit |  This transform counts the records found. Though you can count by any field, very often id field is
used. 
|Count Distinct |Text, Integer, ID, Money, Timestamp, Org_unit | This transform counts the number of records with unique value in the field. If two records
have the same value in the field, they will be counted once only. A typical example of using Count Distinct
is counting the number of active patrons who borrowed items at a library. Each patron can be counted once
only but he/she may borrow multiple items. Transforming the patron id in circulation record with Count
Distinct will result in the required number. Since each patron has a unique id, she/her will be counted once
only. 
|Max |Text, Integer, Money, and Timestamp | It compares the values in the field of all result records and then returns the one record with the
highest value. For timestamp the highest value means
the latest date. For example, if a checkout date is transformed by Max, the returned date is the last checkout
date.
|Min |Text, Integer, Money, and Timestamp | It works the same way as Max except that it returns the lowest value. 
|First Value 
|Last Value
|First 5 characters (for US ZIP code) |N/A | Not applicable to Sitka's Evergreen


Operators
^^^^^^^^^

Operators describe how two pieces of data can be compared to each other. They are used when creating filters
in a template to determine which records should be included in the result. The record is included when the
comparison returns "TRUE". The possible ways of comparing data are related to data type and data transforms.
The available operators are:

[options="header"]
|===
|Operator |Description    |Notes
|Equals | Compares two operands and returns TRUE if they are exactly the same.
|Contains Matching Substring | This operator checks if any part of the field matches the given parameter. It is
case-sensitive.
|Contains Matching Substring (Ignore Case) | This operator is identical to Contains Matching Substring, except
it is not case-sensitive.
|Greater Than | This operator returns TRUE if a field is greater than your parameter. For text fields, the
string is compared character by character in accordance with the general rule that numerical characters are
smaller than alphabetical characters and upper case alphabeticals are smaller than lower case alphabeticals; 
for timestamps "Greater Than" can be thought of as "later than" or "after".
|Greater than or equal to 
|Less Than | This operator returns TRUE if a field is less than, lower than, earlier than or smaller than your
parameter.
|In List| It is similar to Equals, except it allows you specify multiple parameters and returns "TRUE" if the
field is equal to any one of the given values.
|Not In List |  It is the opposite of In List. Multiple parameters can be specified. TRUE will be returned only
when none of the parameters is matched with the value in the field.
|Between | Two parameters are required by this operator. TRUE is returned when the field value is Greater Than
or Equal to the smaller given value and Less Than or Equal to the bigger given value. The smaller parameter
should always comes first when filling in a filter with this operator. For example: between 3 and 5 is
correct. Between 5 and 3 will return FALSE on the Reports interface. For timestamp earlier date always comes
first.
|Not Between 
|Is NULL 
|Is not NULL 
|Is NULL or Blank | Returns TRUE for fields that contain no data or blank string. For most intents and purposes
this operator should be used when there is no visible value in the field.
|Is not NULL or Blank 




Filter Values
^^^^^^^^^^^^^